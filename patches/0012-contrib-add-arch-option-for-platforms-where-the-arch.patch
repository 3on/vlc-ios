From f8d45c80b2901cb3109c5b07cdaf4953b491be66 Mon Sep 17 00:00:00 2001
From: =?UTF-8?q?Felix=20Paul=20K=C3=BChne?= <fkuehne@videolan.org>
Date: Thu, 3 Oct 2013 18:27:43 +0200
Subject: [PATCH 12/16] contrib: add arch option for platforms where the arch
 triplet would be ambigous

---
 contrib/bootstrap | 11 ++++++++++-
 1 file changed, 10 insertions(+), 1 deletion(-)

diff --git a/contrib/bootstrap b/contrib/bootstrap
index e5c7022..cc170a2 100755
--- a/contrib/bootstrap
+++ b/contrib/bootstrap
@@ -30,6 +30,7 @@ usage()
 	echo "  --disable-sout   configure to not build stream output packages"
 	echo "  --enable-small   optimize libraries for size with slight speed decrease [DANGEROUS]"
 	echo "  --disable-gpl    configure to not build viral GPL code"
+	echo "  --arch=ARCH      configure to set the target architecture if host triple is ambigous"
 }
 
 BUILD=
@@ -40,6 +41,7 @@ PKGS_DISABLE=
 BUILD_ENCODERS="1"
 BUILD_DISCS="1"
 GPL="1"
+ARCH=
 
 if test ! -f "../../contrib/src/main.mak"
 then
@@ -81,6 +83,9 @@ do
 		--enable-*)
 			PKGS_ENABLE="${PKGS_ENABLE} ${1#--enable-}"
 			;;
+		--arch=*)
+			ARCH="${1#--arch=}"
+			;;
 		*)
 			echo "Unrecognized options $1"
 			usage
@@ -188,6 +193,7 @@ test -z "$BUILD_DISCS" || add_make_enabled "BUILD_DISCS"
 test -z "$BUILD_ENCODERS" || add_make_enabled "BUILD_ENCODERS"
 test -z "$ENABLE_SMALL" || add_make_enabled "ENABLE_SMALL"
 test -z "$GPL" || add_make_enabled "GPL"
+test -z "$ARCH" || add_make "ARCH := $ARCH"
 
 #
 # Checks
@@ -200,7 +206,10 @@ case "${OS}" in
 			check_macosx_sdk
 			add_make_enabled "HAVE_MACOSX" "HAVE_DARWIN_OS" "HAVE_BSD"
 		else
-			add_make_enabled "HAVE_IOS" "HAVE_DARWIN_OS" "HAVE_BSD" "HAVE_NEON" "HAVE_ARMV7A"
+ 			add_make_enabled "HAVE_IOS" "HAVE_DARWIN_OS" "HAVE_BSD" "HAVE_NEON"
+ 			if [ "$ARCH" != "arm64" ]; then
+ 				add_make_enabled "HAVE_ARMV7A"
+ 			fi
 		fi
 		;;
 	*bsd*)
-- 
1.8.3.4 (Apple Git-47)

